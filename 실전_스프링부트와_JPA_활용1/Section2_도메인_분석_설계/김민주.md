## ⚽️ 도메인 분석 설계

### 요구사항 분석

- 회원 기능 : 회원 가입, 회원 목록
- 상품 기능 : 상품 등록, 상품 목록
- 주문 기능 : 상품 주문, 주문 내역

## ⚽️ 도메인 모델과 테이블 설계

- 회원과 주문 : 회원은 여러 상품을 주문할 수 있음(일대다)
- 회원과 상품 : 회원은 여러 개의 주문을 할 수 있고 상품도 여러 개의 주문에 담길 수 있음(다대다)
  - 중간 테이블 주문상품으로 다대다를 일대다로 해소
- 상품과 카테고리 : 상품은 여러 카테고리에 해당 할 수 있고 카테고리에는 여러 상품이 담길 수 있음(다대다)

### 연관관계 매핑 분석

- 회원과 주문 : 일대다, `ORDERS.member`을 `ORDERS.MEMBER_ID`외래키와 매핑
- 주문상품과 주문 : 다대일 양방향 관계, 주문상품이 주인, `OrderItem.order`을 `ORDER_ITEM.ORDER_ID`외래키와 매핑
- 주문상품과 상품 : 단방향 다대일
- 주문과 배송 : 일대일 단방향 관계
- 카테고리와 상품 : `@ManyToMany` 사용

## ⚽️ 엔티티 클래스 개발

- `@manyToMany`는 단순 매핑은 가능하지만 부가정보를 넣을 수 없기 때문에 실무에서 사용하지는 않음
- Getter와 Setter은 전부 제공하기 보다는 필요한 별도의 메서드를 제공하는 것이 이상적
  - 엔티티 데이터는 조회할 일이 많으므로 Getter은 열어두는 것이 편리
  - 호출해도 변경이 일어나지 않는 Getter와 다르게 Setter은 변경이 일어나 변경 시점을 알기 어려움
  - Setter 대신 변경을 위한 비즈니스 메서드를 별도로 제공
- 생성자에서 값을 모두 초기화해서 값을 변경할 수 없도록 하자
- JPA 스펙상 기본생성자는 `protected`
  - 리플렉션 같은 기술을 사용할 수 있도록 지원하기 위해서

## ⚽️ 엔티티 설계시 주의점

- 엔티티에는 가급적 Setter을 사용하지 말자
  - 변경점이 많아서 유지보수하기 힘듦
- **모든 연관관계는 지연로딩으로 설정**
  - 즉시로딩(연관된 것들을 한번에 로딩)은 예측이 어려움
  - 기본적으로 지연로딩으로 설정
  - 연관된 엔티티들을 함께 DB에서 조회해야하면 fetch join 또는 그래프 기능 사용
  - @OneToOne, ManyToOne은 기본이 즉시로딩이므로 직접 지연로딩으로 설정
- 컬렉션은 필드에서 초기화
