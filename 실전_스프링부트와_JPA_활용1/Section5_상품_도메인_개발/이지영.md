# ìƒí’ˆ ë„ë©”ì¸ ê°œë°œ

# ğŸ® ìƒí’ˆ ë„ë©”ì¸ ê°œë°œ

- ìƒí’ˆ ì—”í‹°í‹° ê°œë°œ(+ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
    
    ```java
    - Item ì¶”ê°€
    //ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    public void addStock(int quantity) {
        this.stockQuantity += quantity;
    }
    
    public void removeStock(int quantity) {
        int restStock = this.stockQuantity - quantity;
        if (restStock < 0) {
            throw new NotEnoughStockException("need more stock");
        }
        this.stockQuantity = restStock;
    }
    
    //exception class ì¶”ê°€
    package com.jpabook.jpashop.exception;
    
    public class NotEnoughStockException extends RuntimeException{
    
        public NotEnoughStockException() {
            super();
        }
    
        public NotEnoughStockException(String message) {
            super(message);
        }
    
        public NotEnoughStockException(String message, Throwable cause) {
            super(message, cause);
        }
    
        public NotEnoughStockException(Throwable cause) {
            super(cause);
        }
    
        protected NotEnoughStockException(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {
            super(message, cause, enableSuppression, writableStackTrace);
        }
    }
    ```
    
- ìƒí’ˆ ë¦¬í¬ì§€í† ë¦¬ ê°œë°œ
    
    ```java
    package com.jpabook.jpashop.repository;
    
    import com.jpabook.jpashop.domain.item.Item;
    import jakarta.persistence.EntityManager;
    import lombok.RequiredArgsConstructor;
    import org.springframework.stereotype.Repository;
    
    import java.util.List;
    
    @Repository
    @RequiredArgsConstructor
    public class ItemRepository {
        private final EntityManager em;
    
        public void save(Item item) {
            if (item.getId() == null) {
                em.persist(item);
            } else {
                em.merge(item);
            }
        }
    
        public Item findOne(Long id) {
            return em.find(Item.class, id);
        }
    
        public List<Item> findAll() {
            return em.createQuery("select i from Item i", Item.class).getResultList();
        }
    }
    ```
    
- ìƒí’ˆ ì„œë¹„ìŠ¤ ê°œë°œ
    - ìƒí’ˆ ë¦¬í¬ì§€í† ë¦¬ì— ë‹¨ìˆœíˆ ìœ„ì„ë§Œ í•˜ëŠ” í´ë˜ìŠ¤ì„.
    
    ```java
    package com.jpabook.jpashop.service;
    
    import com.jpabook.jpashop.domain.item.Item;
    import com.jpabook.jpashop.repository.ItemRepository;
    import lombok.RequiredArgsConstructor;
    import org.springframework.stereotype.Service;
    import org.springframework.transaction.annotation.Transactional;
    
    import java.util.List;
    
    @Service
    @Transactional(readOnly = true)
    @RequiredArgsConstructor
    public class ItemService {
        private final ItemRepository itemRepository;
        @Transactional
        public void saveItem(Item item) {
            itemRepository.save(item);
        }
        public List<Item> findItems() {
            return itemRepository.findAll();
        }
        public Item findOne(Long itemId) {
            return itemRepository.findOne(itemId);
        }
    }
    ```
    

---
