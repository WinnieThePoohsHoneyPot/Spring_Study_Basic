# HTTP 기본

## 🌐 모든 것이 HTTP

- HTTP 메시지에 모든 데이터형태를 다 전송함
- HTML, TEXT, 이미지, 음성, 영상, 파일, JSON, XML, (API) …
- 거의 모든 형태의 데이터 전송 가능
- 서버간 데이터를 주고 받을 때도 대부분 HTTP 사용
- 지금은 HTTP 시대다!
- 현재 **HTTP/1.1** 가장 많이 사용하고 우리에게 가장 중요한 버전
    - 1997 → 1999 → 2014
    - 최신것은 1.1의 성능개선 느낌

### 🌐 기반 프로토콜

- TCP : HTTP/1.1, HTTP
- UDP : HTTP
- 현재 HTTP/1.1 주로 사용
    - HTTP/2, HTTP/3도 점점 증가하는 추세
- 프로토콜 h2 → http/2, h3 → http3

### 🌐 HTTP 특징

- 클라이언트 — 서버 구조
- 무상태 프로토콜(스테이트리스), 비연결성
- HTTP 메시지를 통해서 통신
- 단순, 확장가능

---

## 🌐 클라이언트 서버 구조

- 요청, 응답 구조
- 클라이언트는 서버에 요청을 보내고, 응답을 대기함
- 서버가 요청에 대한 결과를 만들어서 응답함
- 역할을 구분지어서 클라이언트와 서버가 각자의 역할에만 집중할 수 있음.

---

## 🌐 Stateful, Stateless

### 🌐 무상태 프로토콜 = 스테이트리스(Stateless)

- 서버가 클라이언트의 상태를 보존하지 않는것.
- 장점
    - 서버 확장성 높음
- 단점
    - 클라이언트가 추가 데이터를 전송해야함.

### 🌐 Stateful - 상태유지

- 상황1
    - 고객이 노트북을 구매하려고함.
    - 점원이 100만원이라고 하고 2개를 현금과 신용카드중 신용카드를 사용하여 결제하려고 함.

- 상황2 - 점원이 중간에 바뀌면?
    - 상황1의 점원이 바쁜일이 있어서 2점원이 응대함 그리고 손님이 2개 구매한다고 함
    - 점원2는 무엇을 2개 구매하는지 모름

- 정리 → 상태유지를 한다면?
    - 이전의 상태를 유지하는것.
    - 즉, 노트북, 2개, 신용카드의 상태를 유지하는것.
        - 즉, 중간에 다른 점원으로 바뀌면 안됨,
            - 바뀐때는 상태 정보를 다른 점원에게 미리 알려줘야함.

### 🌐 Stateless - 무상태

- 상황 1
    - 고객 : 노트북 2개를 구매하겠습니다.
    - 점원 : 노트북 2개는 200만원 입니다. 신용카드, 현금중에 어떤 걸로 구매 하시겠어요?
    - 고객: 노트북 2개를 신용카드로 구매하겠습니다
    - 점원: 200만원 결제 완료되었습니다

- 상황 2 - 점원이 중간에 바뀌면?
    - 해당 고객은 계속해서 모든 상태를 말해줌으로 응대에 문제가 없는것.

- 정리
    - 중간에 다른 점원으로 바뀌어도 됨.
    - 필요한 모든데이터를 계속해서 전부 넘겨주는것.
    - 무상태는 응답서버를 쉽게 바꿀 수 있음 → 무한한 서버 증설이 가능함.

- 실무한계
    - 모든 것을 무상태로 설계 할 수 있는 경우도, 없는 경우도 존재함
    - 무상태
        - ex) 로그인 필요없는 단순 서비스 소개 화면
    - 상태 유지
        - ex) 로그인
    - 로그인한 사용자의 경우 로그인 상태를 서버에 유지해야함.
    - 일반적으로 브라우저 쿠키와 서버 세션등을 사용해서 상태를 유지함.
    - 상태 유지는 최소한만 사용해야함.
    - 데이터를 너무 많이 전송해야함.
        - 그렇지만 최대한 무상태로 설계하고 어쩔수 없는경우만 연결하는것.

---

## 🌐 비 연결성 (connectionless)

- TCP/IP 연결을 유지하는 모델
    - 서버는 연결을 계속 유지 → 서버의 자원이 소모되는것.
- TCP/IP 연결을 유지하지 않는 모델
    - 서버는 연결을 유지 하지 않으므로 최소한의 자원을 사용함.
- HTTP는 기본이 연결을 유지하지 않는 모델임
- 초단위의 이하의 빠른 속도로 응답함.
- 1시간동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작음.
    - 즉, 계속 검색버튼을 누르지 않는것이랑 같음.
- 서버 자원을 매우 효율적으로 사용이 가능

### 🌐 한계와 극복

- TCP/IP 연결을 새로 맺어야 함. - 3way 시간 추가됨..
- 웹 브라우저로 사이트 요청시 HTML 뿐만아니라 Javascript, css, 이미지 등 수많은 자원이 함께 다운로드됨.
- HTTP는 지속연결(Persistent Connections)로 문제를 해결함
- HTTP/2, HTTP/3에서는 이것을 더 많이 최적화함.

### 🌐 스테이스리스를 기억하십숑!

- 서버개발자들이 어려워하는 업무
    - 즉, 시간에 딱 맞추어 발생하는 대용량 트래픽
        - 선착순 이벤트, 명절 KTX 예약, 학과 수업등록
        - 저녁 6시 칰킨 할인 이벤트 → 수만명 동시 요청

---

## 🌐 HTTP 메시지

- HTTP 메시지 구조
    
    ![Untitled](https://github.com/eejuuung/Spring_Study_Basic/assets/46306166/9457d5eb-ca85-435b-891c-c30a03da0403)

- HTTP 요청 메시지
    
    ![Untitled 1](https://github.com/eejuuung/Spring_Study_Basic/assets/46306166/7b4d9903-6a14-4a5f-ba67-ab4aa2ef58cf)

- HTTP 응답 메시지
    
    ![Untitled 2](https://github.com/eejuuung/Spring_Study_Basic/assets/46306166/a916a744-0626-49d8-967a-47382dc25bf7)


### 🌐  시작 라인 - 요청메시지

```java
start-line = request-line / status-line
->
request-line = method SP(공백) request-target SP HTTP-version CRLF(엔터)
```

- 요청 메시지 - HTTP 메서드
    
    ```java
    **GET** /search?q=hello&hl=ko HTTP/1.1
    Host: www.google.com
    ```
    
    - 종류: GET, POST, PUT, DELETE…
    - 서버가 수행해야 할 동작 지정
        - GET: 리소스 조회
        - POST: 요청 내역 처리
- 요청 메시지 - 요청 대상
    
    ```java
    GET **/search?q=hello&hl=ko** HTTP/1.1
    Host: www.google.com
    ```
    
    - absolute-path[?query] (절대경로[?쿼리])
    - 절대경로= "/" 로 시작하는 경로
- 요청 메시지 - HTTP 버전
    
    ```java
    GET /search?q=hello&hl=ko **HTTP/1.1**
    Host: www.google.com
    ```
    
- 응답 메시지
    
    ```java
    HTTP/1.1 200 OK 
    Content-Type: text/html;charset=UTF-8
    Content-Length: 3423
    <html>
     <body>...</body>
    </html>
    ```
    
    - HTTP 버전
    - HTTP 상태 코드: 요청 성공, 실패
        - 200: 성공
        - 400: 클라이언트 요청 오류
        - 500: 서버 내부 오류
    - 이유 문구

### 🌐 HTTP 헤더

- header-field = field-name ":" OWS field-value OWS (OWS : 띄어쓰지 허용)
- field-name은 대소문자 구문 없음

![Untitled 3](https://github.com/eejuuung/Spring_Study_Basic/assets/46306166/69ceb70f-12ab-4190-8555-50e103600f24)

- 용도
    - HTTP 전송에 필요한 모든 부가정보
    - 메시지 바디의 내용, 메시지 바디의 크기, 압축, 인증, 요청 클라이언트 정보 등..
    - 필요시 임의의 헤더 추가 가능

### 🌐 HTTP 메시지 바디

- 실제 전송할 데이터
- byte로 표현할 수 있는 모든 데이터 전송 가능.

### 🌐 HTTP

- 단순하고 확장이 가능한 기술!

---
